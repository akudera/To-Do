var v=Object.defineProperty;var p=a=>{throw TypeError(a)};var I=(a,t,e)=>t in a?v(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var r=(a,t,e)=>I(a,typeof t!="symbol"?t+"":t,e),E=(a,t,e)=>t.has(a)||p("Cannot "+e);var l=(a,t,e)=>(E(a,t,"read from private field"),e?e.call(a):t.get(a)),k=(a,t,e)=>t.has(a)?p("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),T=(a,t,e,s)=>(E(a,t,"write to private field"),s?s.call(a,e):t.set(a,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();class g{constructor(t,e="",s=String(Date.now())){this.id=s,this.title=t,this.description=e}}var d,m;class L{constructor(t){k(this,d);r(this,"editTaskId");k(this,m);r(this,"ids",{closeModalBtn:"closeModal",modalInput:"modalInput",modalDescriptionInput:"modalDescriptionInput",searchInput:"searchInput",addTaskButton:"addTask",createTask:"createTask",saveEditChanges:"saveChanges"});r(this,"selectors",{taskList:"[data-js-task-list]",task:"[data-js-task]",taskWrapper:".main__item-wrapper",taskTitle:".main__item-title",modalTitle:"[data-js-modal-title]"});r(this,"svg",{urnIcon:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m10 12 4 4m0-4-4 4M4 6h16m-4 0-.27-.812c-.263-.787-.394-1.18-.637-1.471a2 2 0 0 0-.803-.578C13.939 3 13.524 3 12.695 3h-1.388c-.829 0-1.244 0-1.596.139a2 2 0 0 0-.803.578c-.243.29-.374.684-.636 1.471L8 6m10 0v10.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C15.72 21 14.88 21 13.2 21h-2.4c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C6 18.72 6 17.88 6 16.2V6"/></svg>'});r(this,"tasks",[]);T(this,d,t),T(this,m,"todoTasks"),this.TaskListElement=document.querySelector(this.selectors.taskList),this.modalTitleInput=document.getElementById(this.ids.modalInput),this.modalDescriptionInput=document.getElementById(this.ids.modalDescriptionInput),this.searchInput=document.getElementById(this.ids.searchInput),this.addTaskButton=document.getElementById(this.ids.addTaskButton),this.modalTitle=document.querySelector(this.selectors.modalTitle),this.createTaskButton=document.getElementById(this.ids.createTask),this.saveEditChangesButton=document.getElementById(this.ids.saveEditChanges),this.bindEvents(),this.loadTasksFromLocalStorage(),this.renderTasks()}debounce(t,e=200){let s;return function(...n){clearTimeout(s),s=setTimeout(()=>{t.apply(this,n)},e)}}bindEvents(){this.TaskListElement.addEventListener("click",t=>{this.onTaskClick(t)}),this.bindAddTaskEnterEvent=this.addTaskEnterEvent.bind(this),this.bindEditTaskEnterEvent=this.editTaskEnterEvent.bind(this),this.modalTitleInput.addEventListener("keydown",this.bindAddTaskEnterEvent),this.createTaskButton.addEventListener("click",()=>{this.addTask()}),this.addTaskButton.addEventListener("click",()=>{this.onAddTaskBtnClick()}),this.saveEditChangesButton.addEventListener("click",t=>{this.onEditTaskBtnClick(t)})}onEditTaskBtnClick(t){t.preventDefault(),this.editTaskEvent(t,this.editTaskId)}onAddTaskBtnClick(){this.attachAddEnterEvent(),this.saveEditChangesButton.classList.add("hidden"),this.createTaskButton.classList.remove("hidden"),l(this,d).openModal(),this.modalTitleInput.focus()}onTaskClick(t){var e;if(t.target.matches(".main__item-delete-button")){const s=t.target.closest(this.selectors.task);if(!confirm(`Удалить задачу ${((e=s.querySelector(this.selectors.taskTitle))==null?void 0:e.textContent)||""} ?`))return;const i=this.tasks.findIndex(o=>String(o.id)===String(t.target.closest(this.selectors.task).dataset.id));i!==-1&&this.deleteTask(s,i);return}if(t.target.matches(this.selectors.taskWrapper)||t.target.matches(this.selectors.taskTitle)){const s=t.target.closest(this.selectors.task);this.editTaskMenu(s.querySelector(this.selectors.taskTitle).textContent,this.getDescription(s.dataset.id),s.dataset.id)}}addTaskEnterEvent(t){t.key==="Enter"&&(t.preventDefault(),this.addTask())}editTaskEnterEvent(t){t.key==="Enter"&&(t.preventDefault(),this.editTaskEvent(t,this.editTaskId))}attachAddEnterEvent(){this.modalTitleInput.removeEventListener("keydown",this.bindEditTaskEnterEvent),this.modalTitleInput.addEventListener("keydown",this.bindAddTaskEnterEvent)}attachEditEnterEvent(){this.modalTitleInput.removeEventListener("keydown",this.bindAddTaskEnterEvent),this.modalTitleInput.addEventListener("keydown",this.bindEditTaskEnterEvent)}deleteTask(t,e){this.tasks.splice(e,1),this.saveTasksToLocalStorage(),t.remove(),this.filterTasks(this.searchInput.value)}editTaskEvent(t,e){if(t.preventDefault(),this.modalTitleInput.value.trim()){const s=this.modalTitleInput.value.trim(),n=this.modalDescriptionInput.value.trim(),i=this.tasks.find(o=>String(e)===String(o.id));if(i){i.title=s,i.description=n,this.saveTasksToLocalStorage();const o=this.TaskListElement.querySelector(`[data-id="${e}"] ${this.selectors.taskTitle}`);o.textContent=s}this.modalTitleInput.value="",this.modalDescriptionInput.value="",this.filterTasks(this.searchInput.value),l(this,d).closeModal()}else l(this,d).showError("Укажите заголовок задачи!"),this.modalTitleInput.focus()}loadTasksFromLocalStorage(){const t=localStorage.getItem(l(this,m));if(t)try{const e=JSON.parse(t);this.tasks=e.map(s=>new g(s.title,s.description,s.id))}catch(e){console.error("Ошибка при парсинге задачи из LocalStorage:",e)}}saveTasksToLocalStorage(){localStorage.setItem(l(this,m),JSON.stringify(this.tasks))}renderTasks(t=this.tasks){t.length===0?this.TaskListElement.querySelector(".main__item--info")||(this.TaskListElement.innerHTML='<li class="main__item main__item--info">Список дел пока пуст.</li>'):(this.TaskListElement.innerHTML="",t.forEach(e=>{var s;(s=this.TaskListElement)==null||s.append(this.createTaskElement(e))}))}getDescription(t){const e=this.tasks.find(s=>s.id===t);return(e==null?void 0:e.description)||""}editTaskMenu(t,e,s){this.editTaskId=s,this.attachEditEnterEvent(),this.createTaskButton.classList.add("hidden"),this.saveEditChangesButton.classList.remove("hidden"),this.modalTitle.textContent="Редактировать задачу",this.modalTitleInput.value=t,this.modalDescriptionInput.value=e,l(this,d).openModal()}createTaskElement(t){const e=document.createElement("li");e.dataset.id=t.id,e.setAttribute("data-js-task",""),e.classList.add("main__item");const s=document.createElement("div");s.classList.add("main__item-wrapper"),e.append(s);const n=document.createElement("input");n.setAttribute("type","checkbox"),n.classList.add("main__item-checkbox"),n.setAttribute("id","taskCheckbox"),s.append(n);const i=document.createElement("div");i.classList.add("main__item-custom-checkbox"),i.dataset.jsCheckbox="",s.append(i);const o=document.createElement("span");o.textContent=t.title,o.classList.add("main__item-title"),s.append(o);const u=document.createElement("button");return u.classList.add("main__item-delete-button"),u.ariaLabel="Удалить задачу",u.title="Удалить задачу",u.innerHTML=this.svg.urnIcon,s.append(u),e}addTask(){var t,e,s;if(this.modalTitleInput.value.trim()){const n=this.modalTitleInput.value.trim(),i=this.modalDescriptionInput.value.trim(),o=new g(n,i);this.tasks.unshift(o),this.saveTasksToLocalStorage(),(t=this.TaskListElement)==null||t.prepend(this.createTaskElement(o)),(s=(e=this.TaskListElement)==null?void 0:e.querySelector(".main__item--info"))==null||s.remove(),this.modalTitleInput.value="",this.modalDescriptionInput.value="",this.searchInput.value="",this.filterTasks(),l(this,d).closeModal()}else l(this,d).showError("Укажите заголовок задачи!"),this.modalTitleInput.focus()}filterTasks(t=""){var s,n;if(this.tasks.length===0){this.TaskListElement.querySelector(".main__item--info")||(this.TaskListElement.innerHTML='<li class="main__item main__item--info">Список дел пока пуст.</li>');return}if(!t){this.TaskListElement.querySelectorAll("li.hidden:not(.main__item--info)").forEach(i=>{i.classList.remove("hidden")}),(s=this.TaskListElement.querySelector("[data-js-not-found]"))==null||s.remove();return}if(this.TaskListElement.querySelectorAll("li:not(.main__item--info)").length>0){const i=t.toLowerCase().trim();this.TaskListElement.querySelectorAll("li:not(.main__item--info)").forEach(o=>{o.textContent.toLowerCase().includes(i)?o.classList.remove("hidden"):o.classList.add("hidden")})}const e=this.TaskListElement.querySelectorAll("li:not(.main__item--info):not(.hidden)");if(e.length===0&&this.tasks.length!==0&&!this.TaskListElement.querySelector(".main__item--info")){const i=document.createElement("li");i.textContent="По вашему запросу ничего не найдено :(",i.classList.add("main__item","main__item--info"),i.setAttribute("data-js-not-found",""),this.TaskListElement.append(i)}e.length>0&&((n=this.TaskListElement.querySelector("[data-js-not-found]"))==null||n.remove())}}d=new WeakMap,m=new WeakMap;class C{constructor(){r(this,"selectors",{modal:"[data-js-modal]",modalError:"[data-js-modal-error]",modalTitle:"[data-js-modal-title]"});r(this,"ids",{closeModalBtn:"closeModal",modalInput:"modalInput",modalDescriptionInput:"modalDescriptionInput"});r(this,"html",document.querySelector("html"));this.modalElement=document.querySelector(this.selectors.modal),this.errorMessageElement=document.querySelector(this.selectors.modalError),this.closeModalButton=document.getElementById(this.ids.closeModalBtn),this.modalTitleInput=document.getElementById(this.ids.modalInput),this.modalDescriptionInput=document.getElementById(this.ids.modalDescriptionInput),this.modalTitle=document.querySelector(this.selectors.modalTitle)}openModal(){this.modalElement.showModal(),this.html.classList.add("lock")}closeModal(){this.modalTitle.textContent="Новая задача",this.errorMessageElement.textContent="",this.modalTitleInput.value="",this.modalDescriptionInput.value="",this.modalElement.close(),this.html.classList.remove("lock")}showError(t){this.errorMessageElement.textContent=t}}var c;class w{constructor(){k(this,c);r(this,"selectors",{switchThemeButton:"[data-js-theme-switcher]"});r(this,"themes",{dark:"dark",light:"light"});r(this,"stateClasses",{isDark:"is-dark-theme"});r(this,"svg",{sun:'<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none"><g clip-path="url(#a)"><path stroke="#BAF6BA" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12.5 1.042v2.083m0 18.75v2.083M4.396 4.396l1.48 1.479m13.25 13.25 1.478 1.48M1.042 12.5h2.083m18.75 0h2.083M4.396 20.604l1.48-1.479m13.25-13.25 1.478-1.48M17.708 12.5a5.208 5.208 0 1 1-10.416 0 5.208 5.208 0 0 1 10.416 0"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h25v25H0z"/></clipPath></defs></svg>',moon:'<svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.875 13.3229C21.7112 15.096 21.0457 16.7858 19.9565 18.1946C18.8673 19.6033 17.3995 20.6727 15.7247 21.2776C14.0499 21.8826 12.2375 21.998 10.4995 21.6105C8.7615 21.223 7.1698 20.3485 5.91067 19.0893C4.65154 17.8302 3.77704 16.2385 3.38951 14.5005C3.00197 12.7625 3.11743 10.9501 3.72237 9.27531C4.32731 7.60053 5.39672 6.13267 6.80545 5.04349C8.21418 3.95431 9.90397 3.28886 11.6771 3.125C10.639 4.52945 10.1394 6.25984 10.2693 8.00147C10.3992 9.7431 11.1499 11.3803 12.3848 12.6152C13.6198 13.8501 15.2569 14.6008 16.9985 14.7307C18.7402 14.8606 20.4706 14.361 21.875 13.3229Z" stroke="#1E1E1E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'});T(this,c,"theme"),this.switchThemeButton=document.querySelector(this.selectors.switchThemeButton),this.bindEvents(),this.setInitialTheme()}get isDarkThemeCached(){return localStorage.getItem(l(this,c))?localStorage.getItem(l(this,c))===this.themes.dark:document.documentElement.matches(`.${this.stateClasses.isDark}`)}bindEvents(){this.switchThemeButton.addEventListener("click",()=>{this.switchTheme()})}setIconImage(){this.isDarkThemeCached?this.switchThemeButton.innerHTML=this.svg.sun:this.switchThemeButton.innerHTML=this.svg.moon}setInitialTheme(){const t=this.isDarkThemeCached;if(localStorage.getItem(l(this,c)))document.documentElement.classList.toggle(this.stateClasses.isDark,t);else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle(this.stateClasses.isDark,e)}this.setIconImage()}switchTheme(){this.isDarkThemeCached?localStorage.setItem(l(this,c),this.themes.light):localStorage.setItem(l(this,c),this.themes.dark),document.documentElement.classList.toggle(this.stateClasses.isDark,this.isDarkThemeCached),this.setIconImage()}}c=new WeakMap;new w;const h=new C,f=new L(h),y=document.getElementById("searchInput");h.modalElement.addEventListener("mousedown",a=>{(a.target===h.modalElement||a.target===h.closeModalButton)&&h.closeModal()});h.closeModalButton.addEventListener("click",()=>{h.closeModal()});y.addEventListener("input",f.debounce(a=>f.filterTasks(a.target.value)));
